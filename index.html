<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, minimum-scale=1.0">
    <title>:))))))</title>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-R99W86G5LP"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-R99W86G5LP', { 'send_page_view': false });
        //gtag('config', 'G-YZE2B1LT9P');
    </script>
    <style>
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            background: linear-gradient(rgba(255, 230, 230, 0.3), rgba(255, 230, 230, 0.3)),
                        url('Images/camille-minouflet-d7M5Xramf8g-unsplash.jpg');
            background-size: cover;
            background-position: center;
            font-family: 'Arial', sans-serif;
            color: #6d3b5a;
            text-align: center;
            overflow-x: hidden;
            position: relative;
        }

        .invitation-card {
            background-color: #fff0f7;
            padding: clamp(30px, 5vw, 50px);
            border-radius: 20px;
            width: 90%;
            max-width: 800px;
            margin: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            border: 4px solid #ff85a2;
            animation: fadeIn 0.8s ease;
            position: relative;
            z-index: 10;
        }

        .media-container {
            display: flex;
            gap: clamp(10px, 3vw, 20px);
            justify-content: center;
            align-items: center;
            margin-bottom: clamp(20px, 3vw, 30px);
            flex-wrap: wrap;
        }

        .adventure-image, .adventure-gif {
            width: clamp(200px, 40vw, 250px);
            height: clamp(200px, 40vw, 250px);
            border-radius: 15px;
            border: 4px solid #ff85a2;
            box-shadow: 0 6px 15px rgba(255, 133, 162, 0.2);
            object-fit: cover;
        }

        h1 {
            font-size: clamp(20px, 4vw, 28px);
            margin-bottom: clamp(20px, 3vw, 28px);
            line-height: 1.4;
            color: #8b4665;
            padding: 0 clamp(10px, 3vw, 20px);
        }

        .buttons {
            display: flex;
            justify-content: center;
            gap: clamp(10px, 3vw, 20px);
            margin-top: clamp(20px, 3vw, 35px);
            position: relative;
            flex-wrap: wrap;
        }

        button {
            padding: clamp(12px, 3vw, 15px) clamp(25px, 5vw, 35px);
            font-size: clamp(16px, 3vw, 18px);
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-weight: bold;
            z-index: 20;
            min-width: 120px;
        }

        #yesBtn {
            background-color: #ff85a2;
            color: white;
            box-shadow: 0 6px 12px rgba(255, 133, 162, 0.3);
        }

        #yesBtn:hover {
            background-color: #ff6b8f;
            transform: translateY(-3px);
            box-shadow: 0 8px 16px rgba(255, 107, 143, 0.4);
        }

        #noBtn {
            background-color: #fff;
            color: #ff85a2;
            border: 2px solid #ff85a2;
        }

        #noBtn:hover {
            background-color: #ffe6eb;
        }

        .success-message {
            display: none;
            flex-direction: column;
            align-items: center;
            font-size: clamp(22px, 4vw, 28px);
            color: #ff85a2;
            margin: clamp(20px, 3vw, 30px) 0;
            animation: fadeIn 0.5s ease;
            padding: clamp(15px, 3vw, 20px);
        }

        .success-image {
            width: clamp(150px, 30vw, 250px);
            height: auto;
            border-radius: 15px;
            margin-bottom: 20px;
            border: 4px solid #ff85a2;
            box-shadow: 0 6px 15px rgba(255, 133, 162, 0.2);
            animation: fadeIn 0.8s ease;
        }

        .no-button-image {
            position: absolute;
            width: 150px;
            height: 150px;
            background-image: url('Images/polite_cat.jpg');
            background-size: contain;
            background-repeat: no-repeat;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.5s;
            z-index: 2000;
        }

        .show-image {
            opacity: 1;
        }

        .weather-widget {
            position: fixed;
            top: 20px;
            right: 20px;
            background-color: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            padding: 15px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            border: 2px solid #ff85a2;
            z-index: 1000;
            width: 180px;
            font-family: 'Arial', sans-serif;
            animation: fadeIn 1s ease;
        }

        .weather-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            color: #6d3b5a;
        }

        .weather-location {
            font-weight: bold;
            font-size: 16px;
        }

        .weather-date {
            font-size: 14px;
            opacity: 0.8;
        }

        .weather-main {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }

        .weather-icon {
            width: 50px;
            height: 50px;
            margin-right: 10px;
        }

        .weather-temp {
            font-size: 24px;
            font-weight: bold;
            color: #ff85a2;
        }

        .weather-details {
            font-size: 13px;
            color: #6d3b5a;
        }

        .weather-detail {
            display: flex;
            justify-content: space-between;
            margin-bottom: 4px;
        }

        @media (max-width: 768px) {
            .weather-widget {
                top: 10px;
                right: 10px;
                width: 160px;
                padding: 10px;
            }

            .weather-icon {
                width: 40px;
                height: 40px;
            }

            .weather-temp {
                font-size: 20px;
            }
        }

        @media (max-width: 480px) {
            .weather-widget {
                position: static;
                width: auto;
                margin: 20px auto;
                max-width: 300px;
            }
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes tinyJump {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-8px); }
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
</head>
<body>
    <div class="invitation-card">
        <div id="initialContent">
            <div class="media-container">
                <img src="Images/cute-cat-cat.gif"
                     alt="Happy Cat"
                     class="adventure-image">
                <img src="Images/curious-cat.gif"
                     alt="Curious Cat"
                     class="adventure-gif">
            </div>

            <h1>
                You are officially invited to spend the best Sunday Ever! üöó <br>
                Just one rule: no stress allowed - only good vibes ‚ú® <br>
                Are you in? üå∏üçπ
            </h1>

            <div class="buttons">
                <button id="yesBtn">Yes üòä</button>
                <button id="noBtn">No üö©üö©üö©</button>
            </div>
        </div>

        <div id="successContent" class="success-message">
            <img src="Images/Image_cat_pew_pew.jpg" alt="Celebration Cat" class="success-image">
            <div class="success-text">
                You will not regret it üòâ <br>
                Let's make some memories! üå∫
            </div>
        </div>
    </div>

    <div id="noButtonImage" class="no-button-image"></div>

    <div class="weather-widget">
        <div class="weather-header">
            <div class="weather-location">San Felice Circeo</div>
            <div class="weather-date">Sunday</div>
        </div>
        <div class="weather-main">
            <img src="" alt="Weather Icon" class="weather-icon" id="weatherIcon">
            <div class="weather-temp" id="weatherTemp">--¬∞C</div>
        </div>
        <div class="weather-details">
            <div class="weather-detail">
                <span>Condition:</span>
                <span id="weatherCondition">--</span>
            </div>
            <div class="weather-detail">
                <span>Wind:</span>
                <span id="weatherWind">--</span>
            </div>
            <div class="weather-detail">
                <span>Rain:</span>
                <span id="weatherRain">--</span>
            </div>
        </div>
    </div>

    <script>
        const yesBtn = document.getElementById('yesBtn');
        const noBtn = document.getElementById('noBtn');
        const initialContent = document.getElementById('initialContent');
        const successContent = document.getElementById('successContent');
        const noButtonImage = document.getElementById('noButtonImage');
        let noBtnClicked = false;
        let isImageVisible = false;
        let firstButtonClicked = false;

        // Array of image/GIF file paths
        const noButtonImages = [
            'Images/polite_cat.jpg',
            'Images/300px-Crying_Cat_with_paw_up.jpg',
            'Images/bottle_cat.jpg',
            'Images/burrito_cat.jpg',
            'Images/catsad-sad.gif'
        ];

        // Yes button handler
        yesBtn.addEventListener('click', () => {
            // Hide initial content
            initialContent.style.display = 'none';

            // Hide No button and its image
            noBtn.style.display = 'none';
            noButtonImage.style.display = 'none';
            hideImage();

            // Show success content properly
            successContent.style.display = 'flex';
            document.querySelector('.invitation-card').style.padding = '60px 40px';

            // Force reflow to trigger animation
            void successContent.offsetWidth;

            // Confetti explosion
            const count = 200;
            const defaults = { origin: { y: 0.7 } };

            function fire(particleRatio, opts) {
                confetti(Object.assign({}, defaults, opts, {
                    particleCount: Math.floor(count * particleRatio),
                    colors: ['#ff85a2', '#ff6b8f', '#ffffff']
                }));
            }

            fire(0.25, { spread: 26, startVelocity: 55 });
            fire(0.2, { spread: 60 });
            fire(0.35, { spread: 100, decay: 0.91, scalar: 0.8 });
            fire(0.1, { spread: 120, startVelocity: 25, decay: 0.92, scalar: 1.2 });
            fire(0.1, { spread: 120, startVelocity: 45 });

            const eventLabel = firstButtonClicked ? 'Yes Button' : 'Yes Button - First Click';
            gtag('event', 'yes_button_click', {
                'event_category': 'Invitation',
                'event_label': eventLabel
            });
            gtag('event', 'view', {
                'event_category': 'Invitation',
                'event_label': 'Success Message Displayed'
            });
            firstButtonClicked = true;
        });

        function showImageAtPosition(buttonRect) {
            // Ensure the image is always within the viewport
            const imageWidth = 75;
            const imageHeight = 75;
            
            // Calculate screen dimensions
            const screenWidth = window.innerWidth;
            const screenHeight = window.innerHeight;
            
            // Calculate initial position
            let offsetX = buttonRect.left + buttonRect.width / 2 - imageWidth / 2;
            let offsetY = buttonRect.top - imageHeight - 10;
            
            // Adjust X position if it goes out of bounds
            if (offsetX < 0) {
                offsetX = 10; // Small padding from left
            } else if (offsetX + imageWidth > screenWidth) {
                offsetX = screenWidth - imageWidth - 10; // Small padding from right
            }
            
            // Adjust Y position if it goes out of bounds
            if (offsetY < 0) {
                offsetY = buttonRect.bottom + 10; // Position below the button if above screen
            } else if (offsetY + imageHeight > screenHeight) {
                offsetY = screenHeight - imageHeight - 10; // Small padding from bottom
            }

            noButtonImage.style.left = `${offsetX}px`;
            noButtonImage.style.top = `${offsetY}px`;
            noButtonImage.classList.add('show-image');
            isImageVisible = true;
        }

        function hideImage() {
            noButtonImage.classList.remove('show-image');
            isImageVisible = false;
        }

        // No button handler
        noBtn.addEventListener('mouseenter', () => {
            if (!noBtnClicked) {
                noBtn.style.animation = 'tinyJump 0.3s';
                setTimeout(() => noBtn.style.animation = '', 300);
            }
        });

        noBtn.addEventListener('click', (e) => {
            if (!noBtnClicked) {
                e.preventDefault();
                noBtnClicked = true;
                noBtn.parentNode.removeChild(noBtn);
                document.body.appendChild(noBtn);
                noBtn.style.position = 'absolute';
                noBtn.style.zIndex = '1000';
                noBtn.style.cursor = 'pointer';
                moveButtonRandomly();
                const eventLabel = !firstButtonClicked ? 'No Button - First Click' : 'No Button - Initial Click';
                gtag('event', 'no_button_click', {
                    'event_category': 'Invitation',
                    'event_label': eventLabel
                });
                firstButtonClicked = true;
            } else {
                if (isImageVisible) hideImage();
                moveButtonRandomly();
                gtag('event', 'no_button_click', {
                    'event_category': 'Invitation',
                    'event_label': 'No Button - Subsequent Click'
                });
            }
        });

        function moveButtonRandomly() {
            const maxX = window.innerWidth - noBtn.offsetWidth;
            const maxY = window.innerHeight - noBtn.offsetHeight;
            const randomX = Math.floor(Math.random() * maxX);
            const randomY = Math.floor(Math.random() * maxY);

            noBtn.style.left = randomX + 'px';
            noBtn.style.top = randomY + 'px';
            noBtn.style.transition = 'left 0.4s, top 0.4s';
            noBtn.style.transform = `scale(1.1) rotate(${Math.random() * 20 - 10}deg)`;

            // Randomly select an image from the array
            const randomIndex = Math.floor(Math.random() * noButtonImages.length);
            const randomImage = noButtonImages[randomIndex];

            // Set the background image of the noButtonImage element
            noButtonImage.style.backgroundImage = `url('${randomImage}')`;
            noButtonImage.style.backgroundSize = 'contain';
            noButtonImage.style.backgroundRepeat = 'no-repeat';

            setTimeout(() => {
                noBtn.style.transform = 'scale(1) rotate(0)';
                // Wait for the transition to complete plus additional delay
                setTimeout(() => {
                    const rect = noBtn.getBoundingClientRect();
                    showImageAtPosition(rect);
                }, 300); // 300ms delay after transition completes
            }, 300); // 300ms for the initial transition
        }

        // Weather data fetch
        function fetchWeather() {
            const apiKey = 'bd5e378503939ddaee76f12ad7a97608'; // Replace with your actual OpenWeatherMap API key
            const city = 'San Felice Circeo';
            const apiUrl = `https://api.openweathermap.org/data/2.5/forecast?q=${city}&appid=${apiKey}&units=metric`;

            fetch(apiUrl)
                .then(response => response.json())
                .then(data => {
                    const sunday = new Date();
                    const today = new Date();
                    const dayDifference = 7 - today.getDay(); // Calculate days until next Sunday
                    sunday.setDate(today.getDate() + dayDifference);

                    const sundayForecasts = data.list.filter(forecast => {
                        const forecastDate = new Date(forecast.dt * 1000);
                        return forecastDate.getDay() === sunday.getDay();
                    });

                    if (sundayForecasts.length > 0) {
                        // Find a forecast around midday (12:00 PM) on Sunday
                        let closestForecast = sundayForecasts[0];
                        let minTimeDifference = Infinity;
                        const targetHour = 12;

                        sundayForecasts.forEach(forecast => {
                            const forecastDate = new Date(forecast.dt * 1000);
                            const hourDifference = Math.abs(forecastDate.getHours() - targetHour);
                            if (hourDifference < minTimeDifference) {
                                minTimeDifference = hourDifference;
                                closestForecast = forecast;
                            }
                        });
                        updateWeather(closestForecast);
                    } else {
                        // Optionally set default values in the widget if no data is found
                        document.getElementById('weatherTemp').textContent = '--¬∞C';
                        document.getElementById('weatherCondition').textContent = '--';
                        document.getElementById('weatherWind').textContent = '--';
                        document.getElementById('weatherRain').textContent = '--';
                        document.getElementById('weatherIcon').src = '';
                        document.getElementById('weatherIcon').alt = '';
                    }
                })
                .catch(error => {
                    console.error('Error fetching weather data:', error);
                    // Optionally set error message in the widget
                    document.getElementById('weatherTemp').textContent = 'Error';
                    document.getElementById('weatherCondition').textContent = 'Error';
                });
        }

        function updateWeather(data) {
            const temperature = Math.round(data.main.temp);
            const condition = data.weather[0].description;
            const iconCode = data.weather[0].icon;
            const windSpeed = data.wind.speed;
            const rain = data.rain ? (data.rain['3h'] || 0) : 0; // Check for rain in the last 3 hours

            document.getElementById('weatherTemp').textContent = `${temperature}¬∞C`;
            document.getElementById('weatherCondition').textContent = condition;
            document.getElementById('weatherWind').textContent = `${windSpeed} m/s`;
            document.getElementById('weatherRain').textContent = `${rain} mm`;
            document.getElementById('weatherIcon').src = `https://openweathermap.org/img/wn/${iconCode}@2x.png`;
            document.getElementById('weatherIcon').alt = condition;
        }

        // Call weather function when page loads
        window.addEventListener('DOMContentLoaded', fetchWeather);
    </script>
</body>
</html>
